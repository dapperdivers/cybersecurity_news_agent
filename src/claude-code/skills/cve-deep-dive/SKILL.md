---
name: cve-deep-dive
description: Perform detailed analysis of CVE vulnerabilities with IOC extraction and structured output. Use when analyzing specific CVEs or vulnerabilities for threat intelligence.
allowed-tools: Read, Write, mcp__text_analyzer__extract_key_points, mcp__text_analyzer__summarize_text
---

# CVE Deep Dive Analysis

Performs comprehensive analysis of CVE vulnerabilities, extracting key details, IOCs, and mitigation strategies into structured JSON format.

## When to Use This Skill

Use this skill when the user requests:
- Detailed analysis of specific CVE vulnerabilities
- Structured IOC extraction from security bulletins
- Comprehensive vulnerability assessments
- Analysis of security advisories or threat intelligence on vulnerabilities
- Package vulnerability data for dependency scanning (GitHub package search format)

The user typically provides:
- CVE ID (e.g., "Analyze CVE-2026-12345")
- Full article text or URL
- Security bulletin content
- Vulnerability report
- Package vulnerability announcement (for package-vulnerability format)

**Output Formats:**
1. **Standard CVE Analysis** - Comprehensive analysis with IOCs, mitigations, CVSS scores
2. **Package Vulnerability** - Simplified format for dependency scanning tools (package name, affected versions, CVEs)

## Workflow

### Step 1: Determine Output Format

Determine which template to use based on the analysis context:

**Standard CVE Analysis** (default):
- For general vulnerability analysis
- Template: `./templates/cve-analysis.json`
- Output: `/app/outputs/cve-analysis-[CVE-ID]-YYYY-MM-DD.json`

**Package Vulnerability Format** (for dependency scanning):
- When analyzing package/dependency vulnerabilities (npm, PyPI, Maven, etc.)
- When user specifically requests "package vulnerability format" or "GitHub package search format"
- Template: `./templates/package-vulnerability.json`
- Output: `/app/outputs/package-vulnerabilities-YYYY-MM-DD.json`

### Step 2: Load Template

Read the appropriate template based on the output format determined above.

### Step 2: Gather CVE Information

If provided with:
- **CVE ID only**: Search for information in fetched RSS feeds or ask user for content
- **Full article/text**: Use provided content for analysis
- **File path**: Read the file containing CVE details

### Step 3: Extract Key Information

Use `mcp__text_analyzer__extract_key_points` to identify:

1. **CVE Identification**
   - CVE ID (format: CVE-YYYY-NNNNN)
   - Vulnerability title/name

2. **Severity Assessment**
   - CVSS score (0.0-10.0)
   - Severity level: critical/high/medium/low/info
   - CVSS vector string if available

3. **Technical Details**
   - What systems/software are affected
   - Vendors and product names
   - Affected versions or version ranges
   - Attack vector (network, local, physical, adjacent)
   - Complexity and privileges required

4. **Impact Analysis**
   - What can an attacker achieve
   - Confidentiality/Integrity/Availability impact
   - Real-world implications

5. **Exploitation Status**
   - "active" - Actively exploited in the wild
   - "poc_available" - Proof-of-concept exists
   - "theoretical" - No known exploitation

### Step 4: Extract IOCs

Identify and extract indicators of compromise:

**IP Addresses:**
- Any IPs mentioned in threat context
- Command & control servers
- Attack infrastructure

**Domains:**
- Malicious domains
- C2 domains
- Phishing domains related to exploitation

**File Hashes:**
- MD5, SHA1, SHA256 hashes
- Malware samples related to exploitation

**Other Indicators:**
- Registry keys
- File paths
- Mutexes
- User agents
- URLs
- Attack signatures

### Step 5: Document Mitigations

Extract mitigation information:

**Patches:**
- Available patches with version numbers
- Security updates
- Links to vendor patches

**Workarounds:**
- Temporary mitigations if no patch available
- Configuration changes
- Compensating controls

**Defensive Measures:**
- Detection rules
- Monitoring recommendations
- Hardening steps

### Step 6: Compile Analysis

Populate the template with extracted information:

```json
{
  "cve_id": "CVE-YYYY-NNNNN",
  "title": "Descriptive vulnerability name",
  "severity": {
    "cvss_score": 9.8,
    "severity_level": "critical",
    "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  },
  "summary": "2-3 sentence technical summary",
  "affected_systems": {
    "vendors": ["Vendor A", "Vendor B"],
    "products": ["Product X v1.x", "Product Y"],
    "versions": ["1.0-2.5", "3.x before 3.2.1"]
  },
  "attack_vector": "Description of how attack works",
  "impact": "What attacker gains/achieves",
  "exploitation_status": "active|poc_available|theoretical",
  "iocs": {
    "ip_addresses": ["1.2.3.4", "5.6.7.8"],
    "domains": ["malicious.example.com"],
    "file_hashes": ["abc123...", "def456..."],
    "other_indicators": ["Registry: HKLM\\..."]
  },
  "mitigations": {
    "patches": ["Update to version X.Y.Z"],
    "workarounds": ["Disable feature X until patched"],
    "defensive_measures": ["Monitor for IOCs", "Implement WAF rules"]
  },
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-...",
    "https://vendor.com/security/advisory/..."
  ],
  "metadata": {
    "analyzed_date": "2026-01-13T14:30:00Z",
    "analyst_notes": "Additional context or observations"
  }
}
```

### Step 7: Write Output

**For Standard CVE Analysis:**

Create the output file:
```
/app/outputs/cve-analysis-[CVE-ID]-YYYY-MM-DD.json
```

For example: `/app/outputs/cve-analysis-CVE-2026-12345-2026-01-13.json`

**For Package Vulnerability Format:**

Create the output file:
```
/app/outputs/package-vulnerabilities-YYYY-MM-DD.json
```

Populate the template with package vulnerability data:

```json
{
  "vulnerabilities": [
    {
      "package": "react",
      "versions": [
        "19.0.0",
        "19.0.1",
        "19.1.0",
        "19.1.1"
      ],
      "cve": "CVE-2025-55182, CVE-2025-55183, CVE-2025-55184",
      "description": "Critical RCE (55182), Information Leak (55183), DoS (55184) in React Server Components",
      "reference": "https://react.dev/blog/2025/12/11/denial-of-service-and-source-code-exposure-in-react-server-components",
      "severity": "critical"
    }
  ]
}
```

**Package Vulnerability Fields:**
- `package`: Package name (e.g., "react", "express", "django")
- `versions`: Array of affected version strings
- `cve`: Comma-separated CVE IDs if multiple CVEs affect the package
- `description`: Brief description of vulnerabilities
- `reference`: URL to official advisory or security announcement
- `severity`: critical | high | medium | low

**CRITICAL OUTPUT REQUIREMENTS:**

1. **Pure JSON only** - No markdown code blocks
2. **Start with `{`** and end with `}`
3. **Match template structure exactly**
4. **Use ISO 8601 dates** for analyzed_date
5. **Empty arrays for missing data** - Never omit fields
6. **CVSS score as float** - 9.8 not "9.8"

### Step 8: Validation

**For Standard CVE Analysis:**

- ✅ Output file exists at expected path
- ✅ Valid JSON structure
- ✅ CVE ID is correct format (CVE-YYYY-NNNNN)
- ✅ Severity assessment is complete (CVSS score and level)
- ✅ At least one affected system documented
- ✅ Mitigation information included
- ✅ References list has at least one URL
- ✅ All arrays properly formatted (empty [] if no data)

**For Package Vulnerability Format:**

- ✅ Output file exists at `/app/outputs/package-vulnerabilities-YYYY-MM-DD.json`
- ✅ Valid JSON structure
- ✅ Vulnerabilities array contains at least one entry
- ✅ Each entry has package name
- ✅ Versions array is not empty
- ✅ CVE field contains valid CVE IDs
- ✅ Reference URL is present
- ✅ Severity is one of: critical, high, medium, low

## Example Output Preview

**For Standard CVE Analysis:**

```
✅ CVE Deep Dive Analysis Complete

CVE: [CVE-ID]
Title: [Vulnerability Name]
Severity: [Level] (CVSS: [Score])

Affected: [Key vendors/products]
Exploitation: [Status]
IOCs Found: [count] IP addresses, [count] domains, [count] hashes

Output: /app/outputs/cve-analysis-[CVE-ID]-[DATE].json
```

**For Package Vulnerability Format:**

```
✅ Package Vulnerability Analysis Complete

Packages Analyzed: [count]
Total Vulnerabilities: [count]

Critical: [count] | High: [count] | Medium: [count] | Low: [count]

Most Affected Packages:
- [package-name]: [version-count] versions affected
- [package-name]: [version-count] versions affected

Output: /app/outputs/package-vulnerabilities-[DATE].json
Format: GitHub Package Search compatible
```

## Error Handling

- **CVE not found**: Ask user to provide CVE details or article text
- **Insufficient information**: Document what's available, flag missing data in analyst_notes
- **No IOCs available**: Leave IOC arrays empty, not null
- **No CVSS score**: Set to 0.0, leave vector empty, note in analyst_notes

## Notes

- Be thorough but accurate - don't speculate on missing information
- Flag uncertainty in analyst_notes
- IOCs should be confirmed from the source material
- Severity assessment should be evidence-based
- Include all available references for verification
- If multiple CVEs in content, analyze each separately
